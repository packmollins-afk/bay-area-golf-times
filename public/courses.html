<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">

  <!-- Primary Meta Tags -->
  <title>Bay Area Golf Courses | 40+ Public Courses in San Francisco Bay Area</title>
  <meta name="title" content="Bay Area Golf Courses | 40+ Public Courses in San Francisco Bay Area">
  <meta name="description" content="Browse 40+ public golf courses across San Francisco, South Bay, East Bay, and North Bay. View course details, ratings, yardage, slope ratings, and book tee times.">
  <meta name="keywords" content="bay area golf courses, public golf courses san francisco, golf courses near me, east bay golf courses, south bay golf courses, north bay golf courses, california golf">
  <meta name="robots" content="index, follow">

  <!-- Canonical URL -->
  <link rel="canonical" href="https://bayareagolf.now/courses.html">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://bayareagolf.now/courses.html">
  <meta property="og:title" content="Bay Area Golf Courses | 40+ Public Courses">
  <meta property="og:description" content="Browse 40+ public golf courses across San Francisco Bay Area. View ratings, yardage, and book tee times.">
  <meta property="og:image" content="https://bayareagolf.now/og-image.svg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:site_name" content="Bay Area Golf">
  <meta property="og:locale" content="en_US">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://bayareagolf.now/courses.html">
  <meta name="twitter:title" content="Bay Area Golf Courses | 40+ Public Courses">
  <meta name="twitter:description" content="Browse 40+ public golf courses across San Francisco Bay Area. View ratings and book tee times.">
  <meta name="twitter:image" content="https://bayareagolf.now/og-image.svg">

  <!-- Geo Meta Tags -->
  <meta name="geo.region" content="US-CA">
  <meta name="geo.placename" content="San Francisco Bay Area">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <meta name="theme-color" content="#2d5a27">

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Bay Area Golf Courses",
    "description": "Directory of 40+ public golf courses in the San Francisco Bay Area",
    "url": "https://bayareagolf.now/courses.html",
    "mainEntity": {
      "@type": "ItemList",
      "name": "Public Golf Courses in Bay Area",
      "numberOfItems": 40,
      "itemListOrder": "https://schema.org/ItemListUnordered"
    },
    "breadcrumb": {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://bayareagolf.now/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Courses",
          "item": "https://bayareagolf.now/courses.html"
        }
      ]
    }
  }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800&family=Source+Serif+4:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #2d5a27;
      --primary-light: #4a7a3f;
      --primary-dark: #1a3d17;
      --bg: #f4f1e8;
      --bg-paper: #f9f6ef;
      --card-bg: #fffef9;
      --text: #3d2914;
      --text-muted: #6b5344;
      --border: #c4a882;
      --border-light: #ddd0bc;
      --gold: #b8860b;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Source Serif 4', Georgia, serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
    }
    .container { max-width: 900px; margin: 0 auto; padding: 0 20px; }

    /* Header */
    header {
      background: linear-gradient(135deg, var(--primary-dark), var(--primary));
      color: #f4f1e8;
      padding: 24px 0;
      border-bottom: 4px solid var(--border);
    }
    header .container { display: flex; justify-content: space-between; align-items: center; }
    header h1 {
      font-family: 'Playfair Display', Georgia, serif;
      font-size: 1.8rem;
      font-weight: 700;
    }
    .header-nav {
      display: flex;
      gap: 10px;
    }
    .nav-btn {
      color: #f4f1e8;
      text-decoration: none;
      font-family: 'Playfair Display', Georgia, serif;
      padding: 8px 14px;
      border: 2px solid rgba(255,255,255,0.5);
      border-radius: 4px;
      transition: all 0.2s;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .nav-btn:hover { background: rgba(255,255,255,0.1); border-color: #fff; }
    .nav-btn.active { background: rgba(255,255,255,0.15); border-color: #fff; }
    .nav-btn svg { width: 16px; height: 16px; }

    /* Search & Controls */
    .controls {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 8px;
      border: 2px solid var(--border-light);
      margin-bottom: 24px;
    }

    .search-row {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
    }
    .search-input {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid var(--border-light);
      border-radius: 6px;
      font-family: 'Source Serif 4', Georgia, serif;
      font-size: 1rem;
      background: var(--bg-paper);
    }
    .search-input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .filter-group label {
      font-family: 'Playfair Display', Georgia, serif;
      font-weight: 600;
      font-size: 0.9rem;
    }
    .filter-group select {
      padding: 8px 12px;
      border: 2px solid var(--border-light);
      border-radius: 4px;
      font-family: 'Source Serif 4', Georgia, serif;
      background: var(--bg-paper);
    }
    .filter-group input[type="text"] {
      width: 80px;
      padding: 8px 12px;
      border: 2px solid var(--border-light);
      border-radius: 4px;
      font-family: 'Source Serif 4', Georgia, serif;
      background: var(--bg-paper);
    }

    .staff-picks-toggle {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: var(--bg-paper);
      border: 2px solid var(--border-light);
      border-radius: 20px;
      cursor: pointer;
      font-family: 'Playfair Display', Georgia, serif;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.2s;
    }
    .staff-picks-toggle:hover { border-color: var(--gold); }
    .staff-picks-toggle.active {
      background: var(--gold);
      color: #fff;
      border-color: #a37700;
    }
    .staff-picks-toggle svg {
      width: 16px;
      height: 16px;
    }

    /* Region chips */
    .region-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid var(--border-light);
    }
    .region-chip {
      padding: 6px 14px;
      background: var(--bg-paper);
      border: 2px solid var(--border-light);
      border-radius: 20px;
      font-family: 'Playfair Display', Georgia, serif;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .region-chip:hover { background: #e8efe6; border-color: var(--primary); }
    .region-chip.active { background: var(--primary); color: #f4f1e8; border-color: var(--primary-dark); }

    /* Course count */
    .course-count {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 16px;
    }

    /* Course list */
    .course-list {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .course-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px 20px;
      background: var(--card-bg);
      border: 2px solid var(--border-light);
      border-radius: 6px;
      text-decoration: none;
      color: inherit;
      transition: all 0.2s;
    }
    .course-item:hover {
      border-color: var(--primary);
      transform: translateX(4px);
    }

    .course-item.staff-pick {
      border-left: 4px solid var(--gold);
    }

    .staff-badge {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      background: var(--gold);
      border-radius: 50%;
      flex-shrink: 0;
    }
    .staff-badge svg {
      width: 14px;
      height: 14px;
      stroke: #fff;
      fill: #fff;
    }

    .course-info { flex: 1; min-width: 0; }
    .course-name {
      font-family: 'Playfair Display', Georgia, serif;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .course-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    .course-meta span { display: flex; align-items: center; gap: 4px; }

    .course-rating {
      display: flex;
      align-items: center;
      gap: 4px;
      font-family: 'Playfair Display', Georgia, serif;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--gold);
    }
    .course-rating svg {
      width: 18px;
      height: 18px;
      fill: var(--gold);
      stroke: var(--gold);
    }

    .course-arrow {
      color: var(--text-muted);
    }

    /* Loading */
    .loading { text-align: center; padding: 60px; color: var(--text-muted); }

    /* Empty state */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-muted);
    }
    .empty-state h3 {
      font-family: 'Playfair Display', Georgia, serif;
      margin-bottom: 8px;
      color: var(--text);
    }

    /* Mobile */
    @media (max-width: 600px) {
      .search-row { flex-direction: column; }
      .filter-row { flex-direction: column; align-items: stretch; }
      .filter-group { justify-content: space-between; }
      .course-item { padding: 14px 16px; }
      .course-rating { font-size: 1rem; }
      .region-chips { gap: 6px; flex-wrap: nowrap; justify-content: space-between; }
      .region-chip { padding: 5px 10px; font-size: 0.75rem; flex: 1; text-align: center; }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Bay Area Golf</h1>
      <nav class="header-nav">
        <a href="/" class="nav-btn">Home</a>
        <a href="/app.html" class="nav-btn">Tee Times</a>
        <a href="/courses.html" class="nav-btn active">Courses</a>
      </nav>
    </div>
  </header>

  <main class="container" style="padding-top: 24px;">
    <div class="controls">
      <div class="search-row">
        <input type="text" class="search-input" id="search" placeholder="Search courses by name or city..." oninput="filterCourses()">
      </div>

      <div class="filter-row">
        <button class="staff-picks-toggle" id="staff-picks-btn" onclick="toggleStaffPicks()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
          Staff Picks
        </button>

        <div class="filter-group">
          <label>Sort:</label>
          <select id="sort" onchange="filterCourses()">
            <option value="name-asc">Name (A-Z)</option>
            <option value="name-desc">Name (Z-A)</option>
            <option value="rating">Rating (Highest)</option>
            <option value="yardage">Yardage (Longest)</option>
            <option value="slope">Difficulty (Slope)</option>
            <option value="distance">Nearest to ZIP</option>
          </select>
        </div>

        <div class="filter-group" id="zip-group" style="display: none;">
          <label>ZIP:</label>
          <input type="text" id="zip" placeholder="94102" maxlength="5" oninput="filterCourses()">
        </div>
      </div>

      <div class="region-chips">
        <button class="region-chip active" data-region="" onclick="selectRegion(this, '')">All</button>
        <button class="region-chip" data-region="San Francisco" onclick="selectRegion(this, 'San Francisco')">SF</button>
        <button class="region-chip" data-region="South Bay" onclick="selectRegion(this, 'South Bay')">South Bay</button>
        <button class="region-chip" data-region="East Bay" onclick="selectRegion(this, 'East Bay')">East Bay</button>
        <button class="region-chip" data-region="North Bay" onclick="selectRegion(this, 'North Bay')">North Bay</button>
      </div>
    </div>

    <div class="course-count" id="course-count"></div>

    <div id="course-list" class="course-list">
      <div class="loading">Loading courses...</div>
    </div>
  </main>

  <script>
    const API_BASE = '/api';
    let allCourses = [];
    let selectedRegion = '';
    let staffPicksOnly = false;

    // ZIP code coordinates (approximate centers)
    const zipCoords = {
      '94102': { lat: 37.7830, lng: -122.4168 }, // SF downtown
      '94103': { lat: 37.7726, lng: -122.4099 },
      '94104': { lat: 37.7914, lng: -122.4019 },
      '94105': { lat: 37.7894, lng: -122.3929 },
      '94107': { lat: 37.7621, lng: -122.3971 },
      '94108': { lat: 37.7929, lng: -122.4075 },
      '94109': { lat: 37.7942, lng: -122.4211 },
      '94110': { lat: 37.7486, lng: -122.4153 },
      '94111': { lat: 37.7989, lng: -122.3999 },
      '94112': { lat: 37.7210, lng: -122.4429 },
      '94114': { lat: 37.7586, lng: -122.4355 },
      '94115': { lat: 37.7858, lng: -122.4378 },
      '94116': { lat: 37.7436, lng: -122.4858 },
      '94117': { lat: 37.7701, lng: -122.4409 },
      '94118': { lat: 37.7817, lng: -122.4612 },
      '94121': { lat: 37.7790, lng: -122.4929 },
      '94122': { lat: 37.7589, lng: -122.4847 },
      '94123': { lat: 37.8008, lng: -122.4375 },
      '94124': { lat: 37.7316, lng: -122.3879 },
      '94127': { lat: 37.7352, lng: -122.4583 },
      '94129': { lat: 37.8005, lng: -122.4647 },
      '94130': { lat: 37.8226, lng: -122.3711 },
      '94131': { lat: 37.7418, lng: -122.4375 },
      '94132': { lat: 37.7216, lng: -122.4769 },
      '94133': { lat: 37.8002, lng: -122.4103 },
      '94134': { lat: 37.7191, lng: -122.4133 },
      '94301': { lat: 37.4443, lng: -122.1505 }, // Palo Alto
      '94040': { lat: 37.3861, lng: -122.0839 }, // Mountain View
      '94086': { lat: 37.3747, lng: -122.0372 }, // Sunnyvale
      '94087': { lat: 37.3512, lng: -122.0321 },
      '95014': { lat: 37.3182, lng: -122.0446 }, // Cupertino
      '95050': { lat: 37.3548, lng: -121.9552 }, // Santa Clara
      '95110': { lat: 37.3486, lng: -121.9018 }, // San Jose
      '95112': { lat: 37.3543, lng: -121.8881 },
      '95120': { lat: 37.2238, lng: -121.8358 },
      '94501': { lat: 37.7652, lng: -122.2416 }, // Alameda
      '94601': { lat: 37.7752, lng: -122.2156 }, // Oakland
      '94602': { lat: 37.8004, lng: -122.2108 },
      '94610': { lat: 37.8118, lng: -122.2448 },
      '94704': { lat: 37.8676, lng: -122.2570 }, // Berkeley
      '94901': { lat: 37.9735, lng: -122.5311 }, // San Rafael
      '94920': { lat: 37.8817, lng: -122.4998 }, // Tiburon
      '94925': { lat: 37.9282, lng: -122.5111 }, // Corte Madera
      '94941': { lat: 37.9065, lng: -122.5322 }, // Mill Valley
      '94947': { lat: 38.1074, lng: -122.5697 }, // Novato
    };

    async function loadCourses() {
      try {
        const res = await fetch(`${API_BASE}/courses?all=true&_t=${Date.now()}`);
        allCourses = await res.json();
        filterCourses();
      } catch (e) {
        document.getElementById('course-list').innerHTML = '<div class="empty-state"><h3>Error loading courses</h3><p>Please try again later.</p></div>';
      }
    }

    function selectRegion(btn, region) {
      selectedRegion = region;
      document.querySelectorAll('.region-chip').forEach(c => c.classList.remove('active'));
      btn.classList.add('active');
      filterCourses();
    }

    function toggleStaffPicks() {
      staffPicksOnly = !staffPicksOnly;
      document.getElementById('staff-picks-btn').classList.toggle('active', staffPicksOnly);
      filterCourses();
    }

    function getDistance(lat1, lng1, lat2, lng2) {
      // Haversine formula
      const R = 3959; // Earth radius in miles
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLng = (lng2 - lng1) * Math.PI / 180;
      const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLng/2) * Math.sin(dLng/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }

    function filterCourses() {
      const searchTerm = document.getElementById('search').value.toLowerCase();
      const sortBy = document.getElementById('sort').value;
      const zip = document.getElementById('zip').value;

      // Show/hide ZIP input based on sort selection
      document.getElementById('zip-group').style.display = sortBy === 'distance' ? 'flex' : 'none';

      let courses = [...allCourses];

      // Filter by search
      if (searchTerm) {
        courses = courses.filter(c =>
          c.name.toLowerCase().includes(searchTerm) ||
          c.city.toLowerCase().includes(searchTerm)
        );
      }

      // Filter by region
      if (selectedRegion) {
        courses = courses.filter(c => c.region === selectedRegion);
      }

      // Filter by staff picks
      if (staffPicksOnly) {
        courses = courses.filter(c => c.is_staff_pick);
      }

      // Sort
      switch (sortBy) {
        case 'name-asc':
          courses.sort((a, b) => a.name.localeCompare(b.name));
          break;
        case 'name-desc':
          courses.sort((a, b) => b.name.localeCompare(a.name));
          break;
        case 'rating':
          courses.sort((a, b) => (b.avg_rating || 0) - (a.avg_rating || 0));
          break;
        case 'yardage':
          courses.sort((a, b) => (b.yardage || 0) - (a.yardage || 0));
          break;
        case 'slope':
          courses.sort((a, b) => (b.slope_rating || 0) - (a.slope_rating || 0));
          break;
        case 'distance':
          if (zip && zipCoords[zip]) {
            const origin = zipCoords[zip];
            courses.forEach(c => {
              c._distance = c.latitude && c.longitude
                ? getDistance(origin.lat, origin.lng, c.latitude, c.longitude)
                : 999;
            });
            courses.sort((a, b) => a._distance - b._distance);
          }
          break;
      }

      renderCourses(courses, sortBy === 'distance' && zip && zipCoords[zip]);
    }

    function renderCourses(courses, showDistance = false) {
      const countEl = document.getElementById('course-count');
      countEl.textContent = `${courses.length} course${courses.length !== 1 ? 's' : ''} found`;

      if (courses.length === 0) {
        document.getElementById('course-list').innerHTML = `
          <div class="empty-state">
            <h3>No courses found</h3>
            <p>Try adjusting your search or filters.</p>
          </div>
        `;
        return;
      }

      document.getElementById('course-list').innerHTML = courses.map(course => `
        <a href="/course/${course.slug}" class="course-item ${course.is_staff_pick ? 'staff-pick' : ''}">
          ${course.is_staff_pick ? `
            <div class="staff-badge" title="Staff Pick">
              <svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
            </div>
          ` : ''}
          <div class="course-info">
            <div class="course-name">${course.name}</div>
            <div class="course-meta">
              <span>${course.city}, ${course.region}</span>
              <span>${course.holes} holes</span>
              ${course.par ? `<span>Par ${course.par}</span>` : ''}
              ${showDistance && course._distance < 999 ? `<span>${course._distance.toFixed(1)} mi</span>` : ''}
            </div>
          </div>
          ${course.avg_rating ? `
            <div class="course-rating">
              <svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
              ${course.avg_rating.toFixed(1)}
            </div>
          ` : ''}
          <span class="course-arrow">â†’</span>
        </a>
      `).join('');
    }

    loadCourses();
  </script>
  <script src="/js/analytics.js"></script>
</body>
</html>
